---
import type { Props } from '@astrojs/starlight/props';
import Default from '@astrojs/starlight/components/Header.astro';
import ThemeSelect from '@astrojs/starlight/components/ThemeSelect.astro';

const isSplash = Astro.props.entry?.data?.template === 'splash';
const logoSrc = '/jolt/favicon.svg';
---

{isSplash ? (
  <header class="landing-header">
    <a href="/jolt/" class="logo-link">
      <img src={logoSrc} alt="jolt" class="logo" />
      <span class="logo-text">jolt</span>
    </a>
    
    <nav class="landing-nav">
      <a href="/jolt/docs/getting-started/" class="docs-button">
        Documentation
      </a>
      <a href="https://github.com/jordond/jolt" target="_blank" rel="noopener" class="icon-button" aria-label="GitHub">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
          <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/>
        </svg>
      </a>
      <div class="theme-toggle">
        <ThemeSelect {...Astro.props} />
      </div>
    </nav>
  </header>
) : (
  <Default {...Astro.props}><slot /></Default>
  <nav class="header-nav">
    <a href="/jolt/docs/getting-started/" class="nav-link">Documentation</a>
  </nav>
)}

<style>
  .landing-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem 2rem;
    background: transparent;
  }

  .logo-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
    color: var(--sl-color-white);
  }

  .logo {
    width: 32px;
    height: 32px;
  }

  .logo-text {
    font-size: 1.25rem;
    font-weight: 600;
    background: linear-gradient(135deg, var(--sl-color-accent), #a855f7);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .landing-nav {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .docs-button {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--sl-color-white);
    text-decoration: none;
    border-radius: 0.5rem;
    background: rgba(0, 212, 255, 0.1);
    border: 1px solid rgba(0, 212, 255, 0.3);
    transition: all 0.2s ease;
  }

  .docs-button:hover {
    background: rgba(0, 212, 255, 0.2);
    border-color: var(--sl-color-accent);
    box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
  }

  .icon-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    color: var(--sl-color-gray-2);
    text-decoration: none;
    border-radius: 0.5rem;
    transition: all 0.2s ease;
  }

  .icon-button:hover {
    color: var(--sl-color-accent);
    background: rgba(0, 212, 255, 0.1);
  }

  .theme-toggle {
    display: flex;
    align-items: center;
  }

  .theme-toggle :global(starlight-theme-select) {
    --sl-color-gray-5: transparent;
  }

  .theme-toggle :global(select) {
    background: transparent;
    border: none;
    color: var(--sl-color-gray-2);
    cursor: pointer;
    padding: 0.5rem;
  }

  .theme-toggle :global(svg) {
    color: var(--sl-color-gray-2);
    transition: color 0.2s ease;
  }

  .theme-toggle:hover :global(svg) {
    color: var(--sl-color-accent);
  }

  /* Doc pages header additions */
  .header-nav {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-right: 0.5rem;
  }

  .nav-link {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--sl-color-gray-2);
    text-decoration: none;
    border-radius: 0.375rem;
    transition: all 0.2s ease;
    border: 1px solid transparent;
  }

  .nav-link:hover {
    color: var(--sl-color-accent);
    background: rgba(0, 212, 255, 0.1);
    border-color: rgba(0, 212, 255, 0.3);
    text-shadow: 0 0 10px rgba(0, 212, 255, 0.4);
  }

  @media (max-width: 600px) {
    .landing-header {
      padding: 0.75rem 1rem;
    }

    .logo-text {
      display: none;
    }

    .docs-button {
      padding: 0.4rem 0.75rem;
      font-size: 0.8rem;
    }

    .nav-link {
      padding: 0.4rem 0.75rem;
      font-size: 0.8rem;
    }
  }
</style>

{isSplash && (
  <script is:inline>
    document.documentElement.setAttribute('data-page-template', 'splash');
  </script>
)}

<script>
  function positionNavLink() {
    const header = document.querySelector('header.header');
    const nav = document.querySelector('.header-nav');
    const socialIcons = header?.querySelector('.sl-flex.social-icons');
    
    if (nav && socialIcons) {
      socialIcons.parentElement?.insertBefore(nav, socialIcons);
    }
  }
  
  positionNavLink();
  document.addEventListener('astro:page-load', positionNavLink);
</script>
